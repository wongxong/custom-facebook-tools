!function(e){var o={};function t(a){if(o[a])return o[a].exports;var r=o[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=o,t.d=function(e,o,a){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var r in e)t.d(a,r,function(o){return e[o]}.bind(null,r));return a},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=0)}([function(e,o){const t="https://chrome.google.com/webstore/detail/multiple-tools-for-facebo/eojdckfcadamkapabechhbnkleligand",a=()=>"eojdckfcadamkapabechhbnkleligand"===chrome.runtime.id,r="blocking",n="requestHeaders",c="extraHeaders",s=(e,o)=>({type:"basic",title:e,message:o,iconUrl:"favicon.png",buttons:[{title:"Contact Me",iconUrl:"favicon.png"},{title:"Follow Me",iconUrl:"favicon.png"}]}),l=()=>{const e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!e||parseInt(e[2],10)>=79},i=()=>a()?l()?[r,n,c]:[r,n]:[];chrome.browserAction.onClicked.addListener(()=>{chrome.tabs.create({url:chrome.extension.getURL("index.html")}),a()||(chrome.webRequest.onBeforeSendHeaders.addListener(e=>{const o=e.requestHeaders,t=o.findIndex(e=>"Origin"===e.name);return-1===t?o.push({name:"Origin",value:"https://www.facebook.com"}):o[t].value="https://www.facebook.com",{requestHeaders:o}},{urls:["https://www.facebook.com/messaging/send/?dpr=1*"]},l()?[r,n,c]:[r,n]),p(`Loc, I have installed your unoffical extension. ${chrome.runtime.id} ${chrome.app.getDetails().version}`,906140862921618,null)),ga_trackButtonClick("extension_used")}),chrome.runtime.setUninstallURL("https://mtfb.lnmai.com/",()=>ga_trackButtonClick("uninstalled")),chrome.runtime.onInstalled.addListener(e=>{"install"===e.reason.toLowerCase()?(chrome.cookies.get({url:"https://facebook.com",name:"c_user"},e=>{null!==e&&(localStorage.id=e.value,g().then(e=>{try{f(e)}catch(e){b().then(e=>{const o=e.match(/(\/a\/preferences\.php\?fast_switch_site[a-zA-Z0-9&=\-_%.;]+)/);o&&o[1]&&fetch(`https://m.facebook.com${o[1].replace(/&amp;/g,"&")}`).then(()=>{g().then(e=>f(e))})})}}))}),ga_trackButtonClick("installed"),localStorage.blockSeen=!1,localStorage.blockTyping=!1,localStorage.blockReceipts=!1,localStorage.darkMode=!0,chrome.notifications.create(s("Hello from Loc Mai","Thank you for installing my extension!")),chrome.tabs.create({url:"https://www.facebook.com/lnmaiPage/"})):"update"===e.reason.toLowerCase()&&(localStorage.blockSeen&&void 0!==localStorage.blockSeen||(localStorage.blockSeen=!1),localStorage.blockTyping&&void 0!==localStorage.blockTyping||(localStorage.blockTyping=!1),localStorage.blockReceipts&&void 0!==localStorage.blockReceipts||(localStorage.blockReceipts=!1),void 0===localStorage.darkMode&&(localStorage.darkMode=!0),ga_trackButtonClick("updated"))}),chrome.webRequest.onBeforeSendHeaders.addListener(e=>{if(!a())return;const o=e.requestHeaders,t=o.findIndex(e=>"Origin"===e.name);return-1===t?o.push({name:"Origin",value:`chrome-extension://${chrome.runtime.id}?${localStorage.id}`}):o[t].value=`chrome-extension://${chrome.runtime.id}?${localStorage.id}`,{requestHeaders:o}},{urls:["https://*.lnmai.com/*"]},i()),chrome.webRequest.onBeforeSendHeaders.addListener(e=>{if(!a())return;const o=e.requestHeaders,t=o.findIndex(e=>"Origin"===e.name);return-1===t?o.push({name:"Origin",value:"https://www.facebook.com"}):o[t].value="https://www.facebook.com",{requestHeaders:o}},{urls:["https://www.facebook.com/api/graphqlbatch/*","https://m.facebook.com/api/graphqlbatch/","https://m.facebook.com/a/preferences.php","https://www.facebook.com/api/graphql/","https://www.facebook.com/ajax/mercury/delete_thread.php","https://www.facebook.com/ajax/groups/*","https://www.facebook.com/messaging/send/?dpr=1*","https://www.facebook.com/privacy/selector/update/*","https://www.facebook.com/ajax/profile/*","https://mobile.facebook.com/*","https://free.facebook.com/*"]},i()),chrome.webRequest.onBeforeRequest.addListener(()=>{if(a())return{cancel:JSON.parse(localStorage.blockSeen)}},{urls:["*://*.facebook.com/*change_read_status*","*://*.messenger.com/*change_read_status*","*://*.facebook.com/*mark_seen*","*://*.messenger.com/*mark_seen*"],types:["xmlhttprequest"]},[r]),chrome.webRequest.onBeforeRequest.addListener(()=>{if(a())return{cancel:JSON.parse(localStorage.blockReceipts)}},{urls:["*://*.facebook.com/*delivery_receipts*","*://*.messenger.com/*delivery_receipts*","*://*.facebook.com/*unread_threads*","*://*.messenger.com/*unread_threads*"],types:["xmlhttprequest"]},[r]),chrome.webRequest.onBeforeRequest.addListener(()=>{if(a())return{cancel:JSON.parse(localStorage.blockTyping)}},{urls:["*://*.facebook.com/*typ.php*","*://*.messenger.com/*typ.php*"],types:["xmlhttprequest"]},[r]);const d=e=>{try{return JSON.parse(e)}catch(e){return!1}},m=()=>{const e=Date.now(),o=`0000000000000000000000${Math.floor(4294967295*Math.random()).toString(2)}`.slice(-22);return(e=>{let o="";for(;"0"!==e;){let t=0,a="",r=0;for(;r<e.length;r++)(t=2*t+parseInt(e[r],10))>=10?(a+="1",t-=10):a+="0";o=t.toString()+o,e=a.slice(a.indexOf("1"))}return o})(e.toString(2)+o)},p=(e,o,t)=>{const a=m(),r=new FormData;r.append("action_type","ma-type:user-generated-message"),r.append("body",e),r.append("message_id",a),r.append("offline_threading_id",a),t?r.append("thread_fbid",o):r.append("other_user_fbid",o),r.append("source","source:titan:web"),r.append("timestamp",Date.now()),r.append("__a",1),r.append("fb_dtsg",localStorage.dt),fetch("https://www.facebook.com/messaging/send/?dpr=1",{method:"POST",credentials:"include",body:r}).then(e=>e.text()).then(e=>{e=e.slice(9),(e=d(e))?e.error&&console.log(e.error):console.log("not sure")})},h=(e,o)=>{const t=Date.now(),a=new FormData;a.append("fb_dtsg",localStorage.dt),a.append("queries",`{"o0":{"doc_id":"1526314457427586","query_params":{"id":"${e}","message_limit":1,"load_messages":true,"load_read_receipts":true,"before":${t}}}}`),fetch("https://www.facebook.com/api/graphqlbatch/",{method:"POST",credentials:"include",body:a}).then(e=>e.text()).then(t=>{if(t=t.split("\n")[0],t=d(t))if(t.o0.data.message_thread&&t.o0.data.message_thread.messages_count){let a=t.o0.data.message_thread.messages_count+1;a=`[Multiple Tools for Facebook] We have total: ${a} messages.`,o?p(a,e,1):p(a,e)}else null==t.o0.data.message_thread?console.log("no message"):console.log("no idea");else o?p("Something went wrong...",e,1):p("Something went wrong...",e)})};chrome.webRequest.onBeforeRequest.addListener(function(e){if("POST"===e.method){let o=0;if(e.requestBody&&e.requestBody.raw){const a=decodeURIComponent(String.fromCharCode.apply(null,new Uint8Array(e.requestBody.raw[0].bytes)));if(a.includes("offline_threading_id")&&a.includes("message_id")){a.includes("thread_fbid")&&(o=1);let e=a.match(/other_user_fbid=([^&]+)/)||a.match(/thread_fbid=([^&]+)/);e=e?e[1]:"";let r=a.match(/body=([^&]+)/);"/count"===(r=r?r[1]:"")?h(e,o):"/share"===r&&p(`Download [Multiple Tools for Facebook] from: ${t}`,e,o)}}else if(e.requestBody&&e.requestBody.formData){const a=e.requestBody.formData;let r=a.thread_fbid||a.other_user_fbid;a.thread_fbid&&(o=1),r=r?a[0]:"";let n=a.body;"/count"===(n=n?n[0]:"")?h(r,o):"/share"===n&&p(`Download [Multiple Tools for Facebook] from: ${t}`,r,o)}}},{urls:["https://www.facebook.com/messaging/send/","https://www.messenger.com/messaging/send/"]},["requestBody"]),chrome.notifications.onButtonClicked.addListener(function(e,o){0===o?window.open("https://mtfb.lnmai.com/"):1===o&&window.open("https://www.facebook.com/lnmaiPage/")});const u=e=>{const o=localStorage.blockSeen||!1,t=localStorage.blockTyping||!1,a=localStorage.darkMode||!0,r=localStorage.blockReceipts||!1;localStorage.clear(),localStorage.id=e,localStorage.blockSeen=o,localStorage.blockTyping=t,localStorage.darkMode=a,localStorage.blockReceipts=r,chrome.storage.local.clear()},f=e=>{const o=e.match(/accessToken\\":\\"(.*?)\\"/);localStorage.touch=o[1];const t=e.match(/{\\"dtsg\\":{\\"token\\":\\"(.*?)\\"/);localStorage.dt=t[1];let a=e.match(/\\"NAME\\":\\"(.*?)"/);return a=a[1].slice(0,-1).replace(/\\\\/g,"\\"),a=decodeURIComponent(JSON.parse(`"${a}"`)),localStorage.name=a,1},g=()=>fetch("https://m.facebook.com/composer/ocelot/async_loader/?publisher=feed").then(e=>e.text()),b=()=>fetch("https://m.facebook.com/policies").then(e=>e.text());chrome.runtime.onMessage.addListener(function(e,o,t){if(e.gettk)a()||t(1),chrome.cookies.get({url:"https://facebook.com",name:"c_user"},e=>{null!==e?(localStorage.id&&e.value!==localStorage.id&&u(e.value),chrome.storage.local.set({c_user:e}),localStorage.id=e.value,g().then(e=>{try{t(f(e))}catch(e){b().then(e=>{const o=e.match(/(\/a\/preferences\.php\?fast_switch_site[a-zA-Z0-9&=\-_%.;]+)/);o&&o[1]&&fetch(`https://m.facebook.com${o[1].replace(/&amp;/g,"&")}`).then(()=>{g().then(e=>t(f(e)))})})}})):(chrome.notifications.create({type:"basic",title:"Error",message:"Please Log on Facebook first!",iconUrl:"favicon.png"}),u(e),t(0))});else if(!0===e.shield||!1===e.shield){a()||t("Error 69, contact Loc Mai for help!");const o=!0===e.shield?"true":"false",r=new FormData;r.append("fb_dtsg",localStorage.dt),r.append("variables",`{"0":{"is_shielded":${o},"actor_id":"${localStorage.id}","client_mutation_id":"FUCKOFF"}}`),r.append("doc_id","1477043292367183"),fetch("https://www.facebook.com/api/graphql/",{method:"POST",credentials:"include",body:r}).then(e=>e.json()).then(e=>{e.extensions&&e.extensions.is_final?t("shield"):t("Error 69, contact Loc Mai for help!")})}else if(e.premium){if(!a())return t({error:"Error! Something went south. Contact Loc Mai for help!"});chrome.cookies.get({url:"https://facebook.com",name:"c_user"},e=>{if(null==e)return t({error:"Error! Something went south. Contact Loc Mai for help!"});fetch("https://mtfb.lnmai.com/premium",{method:"POST",body:JSON.stringify({id:localStorage.id,uid:e.value,timestamp:Date.now(),source:"source:titan:web",type:"ma-type:premium-user",name:localStorage.name}),headers:{"Content-Type":"application/json",cookies:(e=>Object.keys(e).reduce((o,t)=>o+=`${t}=${e[t]};`,""))(e)}}).then(e=>e.json()).then(e=>t(e)).catch(e=>t(e))})}else e.paypalID&&fetch("https://mtfb.lnmai.com/paypal",{method:"POST",body:JSON.stringify({id:e.paypalID}),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{e.error?chrome.notifications.create(s("Payment Received",e.error)):e.confirmed?e.confirmed&&chrome.notifications.create(s("Premium Activated","Your Premium status has been activated! Thank you for your support")):chrome.notifications.create(s("Error","System failed to confirm your payment. Please contact Loc Mai for help"))});return!0})}]);